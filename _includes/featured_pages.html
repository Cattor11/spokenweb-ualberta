<script>
  function move_carousel_page(amount) {
    const chunk = 148;
    const offset = 15;
    let items = document.querySelectorAll(".sp-object-item");
    const size = items.length - 1;


    let container = document.getElementById("wax-gallery-objects");
    let num_visible = Math.floor(container.offsetWidth / chunk) - 1;
    let max_offset = ((size - num_visible) * chunk) - offset;

    items.forEach(x => {
      let current = parseInt(x.style.translate);
      let new_amount = current + (amount * chunk);

      // Check for left overflow
      if (new_amount > offset) {
        new_amount = offset;
      }

      // Check for right overflow
      if (new_amount < -max_offset) {
        new_amount = -max_offset;
      }

      x.style.translate = new_amount.toString() + "px"
    });
  }
</script>

<div id='wax-gallery-objects-container' class='wax-gallery-container full-width'>
  <div class='wax-inline-container'>
    <h3>Featured Pages</h3>
    <div id="wax-gallery-objects" class="wax-gallery">
      <button class="sp-carousel-right-control sp-carousel-control" onClick="move_carousel_page(-1)">&gt;</button>
      <button class="sp-carousel-left-control sp-carousel-control" onClick="move_carousel_page(1)">&lt;</button>
      {% for item_id in page.featured_pages %}
        {% for new_page in site.pages %}
          {% if new_page.title == item_id %}
            {% assign thumbnail = new_page.featured_image | default: 'img/digtape.jpg' | relative_url %}
            <div class='gallery-item sp-page-item all' style="translate: 15px;">
              <a href='{{ new_page | relative_url }}'>
                <div class='hovereffect'>
                  <img class='img-responsive gallery-thumb' src='{{ thumbnail }}'/>
                  <div class='overlay'>
                    {{ new_page.title }}
                  </div>
                </div>
              </a>
            </div>
            {% break %}
          {% endif %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
</div>
